<%= vars.k8s_runtime_abbr %> can deploy Kubernetes clusters with nodes distributed across multiple vSphere datacenters.
The top-level steps for configuring this capability are:

1. In BOSH Director for vSphere, define multiple vCenter Configs that associate the datacenters with different availability zones (AZs).

1. Create Plans in <%= vars.k8s_runtime_abbr %> that run cluster nodes in the different AZs.

**Versions and upgrades**: Support for multiple datacenters, configured via AZs, varies between <%= vars.k8s_runtime_abbr %> patch releases within the same minor release line, with later patch releases supporting the functionality while earlier ones do not.
To enable multiple datacenters for <%= vars.k8s_runtime_abbr %>, you do the following, based on whether it is a new or existing installation:

  * **New installation**: Configure BOSH Director for vSphere to support multiple datacenters, and install a <%= vars.k8s_runtime_abbr %> patch version that supports multiple datacenters.
  * **Existing installation**: Change your BOSH Director for vSphere configuration to support multiple datacenters, and upgrade <%= vars.k8s_runtime_abbr %> to a patch version that supports multiple datacenters.

To enable multi-datacenter support, include the following steps as you configure and deploy BOSH Director for vSphere and <%= vars.product_tile %>:

1. In the vCenter > Networking tab, define a service network under each datacenter.

  * If you are using Antrea networking, not NSX, give each service network the same name, for example `tkgi-service`.

1. Configure the **BOSH Director for vSphere** tile to include these settings:

  1. **vCenter Config**: Create multiple vCenter Configs that have:
      * Different **Name** values that you provide.
      * Different **Datacenter Name** values for the multiple datacenters.
          * If the datacenter is under a folder in your inventory, include the folder in the name, for example `tkgi-folder/dc-2`.
      * The same **vCenter Host** value, which is the address of your vCenter Host account.
      > **Note** The vCenter Host value for each vCenter Config must be the same.
  1. **Create Availability Zones**: Create multiple AZs. Under **IaaS Configuration** for each, set:
      * **Name** to a name that you provide.
      * **IaaS Configuration** to the **Name** of one of your vCenter Configs.
      * Click **Save** to save the AZs, which are used in subsequent configurations.
  1. **Create Networks**: Create a service network, setting:
      * **Name** to a name that you provide.
      * **Subnets** > **vSphere Network Name** to the shared name of the service networks that you created under the datacenters in vCenter.
      * CIDRs and other addresses for the networks can vary.
      * **Availability Zones**: Enable all the AZs that you created for your multiple datacenters.

1. Configure the **<%= vars.product_tile %>** tile > to include these settings:

  * **Assign AZs and Networks**: Set **Service Network** to the name of the service network that you created in the **BOSH Director for vSphere** tile.
  * **Plans**: Create Plans for your Kubernetes clusters, enabling different AZs for **Master/ETCD Availability Zones** and **Worker Availability Zones** to control which datacenters the cluster's control plane and worker nodes can be deployed to.
  * **Kubernetes Cloud Provider**: Set **Datacenter Name** to a comma-separated list of datacenter names as set in the BOSH Director tile's vCenter Configs, for example, `dc-1, tkgi-folder/dc-2`.
